"use strict";(self.webpackChunkFrontend=self.webpackChunkFrontend||[]).push([[853],{3175:(Se,E,h)=>{h.d(E,{a:()=>U});var y=h(2340),p=h(4004),m=h(262),e=h(2843),O=h(5e3),v=h(520),Z=h(263);let U=(()=>{class M{constructor(f,g){this.http=f,this.authService=g,this.url=`${y.N.url_api}/chat`}getAllChats(){return this.http.get(this.url).pipe((0,p.U)(f=>(f=this.cleanChats(f),this.sortChats(f))),(0,m.K)(f=>this.handleError(f)))}getChatId(f){return this.http.post(`${this.url}/getChatId`,{to:f}).pipe((0,m.K)(g=>this.handleError(g)))}getChatInfo(f){return this.http.get(`${this.url}/${f}`).pipe((0,m.K)(g=>this.handleError(g)))}blockChat(f){return this.http.get(`${this.url}/block/${f}`).pipe((0,m.K)(g=>this.handleError(g)))}unlockChat(f){return this.http.get(`${this.url}/unlock/${f}`).pipe((0,m.K)(g=>this.handleError(g)))}getFromUser(f){return this.http.get(`${this.url}/getFromUser/${f}`).pipe((0,m.K)(g=>this.handleError(g)))}handleError(f){return 401===f.status?(this.authService.logout(),(0,e._)("Unauthorized")):(0,e._)("Error unexpected")}sortChats(f){return f.sort((g,x)=>g.lastMessage?x.lastMessage?g.lastMessage.updatedAt>x.lastMessage.updatedAt?-1:1:g.lastMessage.updatedAt>x.createdAt?-1:1:x.lastMessage?g.updatedAt>x.lastMessage.updatedAt?-1:1:g.updatedAt>x.createdAt?-1:1),f}cleanChats(f){const g=this.authService.getMyUser();return f.filter(A=>A.lastMessage||A.users[0]._id==g._id)}}return M.\u0275fac=function(f){return new(f||M)(O.LFG(v.eN),O.LFG(Z.e))},M.\u0275prov=O.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})()},273:(Se,E,h)=>{h.d(E,{$:()=>o});var y={};h.r(y),h.d(y,{Decoder:()=>le,Encoder:()=>st,PacketType:()=>d,protocol:()=>ke});var p={};h.r(p),h.d(p,{Manager:()=>z,Socket:()=>he,connect:()=>T,default:()=>T,io:()=>T,protocol:()=>ke});var m=h(5e3),e=h(8306),O=h(3099);const v=Object.create(null);v.open="0",v.close="1",v.ping="2",v.pong="3",v.message="4",v.upgrade="5",v.noop="6";const Z=Object.create(null);Object.keys(v).forEach(s=>{Z[v[s]]=s});const U={type:"error",data:"parser error"},M="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),L="function"==typeof ArrayBuffer,x=(s,t)=>{const n=new FileReader;return n.onload=function(){const i=n.result.split(",")[1];t("b"+i)},n.readAsDataURL(s)},A=({type:s,data:t},n,i)=>M&&t instanceof Blob?n?i(t):x(t,i):L&&(t instanceof ArrayBuffer||(s=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(s):s&&s.buffer instanceof ArrayBuffer)(t))?n?i(t):x(new Blob([t]),i):i(v[s]+(t||"")),I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let s=0;s<I.length;s++)S[I.charCodeAt(s)]=s;const j="function"==typeof ArrayBuffer,X=(s,t)=>{if(j){const n=(s=>{let i,c,u,_,k,t=.75*s.length,n=s.length,a=0;"="===s[s.length-1]&&(t--,"="===s[s.length-2]&&t--);const ue=new ArrayBuffer(t),G=new Uint8Array(ue);for(i=0;i<n;i+=4)c=S[s.charCodeAt(i)],u=S[s.charCodeAt(i+1)],_=S[s.charCodeAt(i+2)],k=S[s.charCodeAt(i+3)],G[a++]=c<<2|u>>4,G[a++]=(15&u)<<4|_>>2,G[a++]=(3&_)<<6|63&k;return ue})(s);return ee(n,t)}return{base64:!0,data:s}},ee=(s,t)=>"blob"===t&&s instanceof ArrayBuffer?new Blob([s]):s,Ee=(s,t)=>{if("string"!=typeof s)return{type:"message",data:ee(s,t)};const n=s.charAt(0);return"b"===n?{type:"message",data:X(s.substring(1),t)}:Z[n]?s.length>1?{type:Z[n],data:s.substring(1)}:{type:Z[n]}:U},te=String.fromCharCode(30);function C(s){if(s)return function Ze(s){for(var t in C.prototype)s[t]=C.prototype[t];return s}(s)}C.prototype.on=C.prototype.addEventListener=function(s,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+s]=this._callbacks["$"+s]||[]).push(t),this},C.prototype.once=function(s,t){function n(){this.off(s,n),t.apply(this,arguments)}return n.fn=t,this.on(s,n),this},C.prototype.off=C.prototype.removeListener=C.prototype.removeAllListeners=C.prototype.removeEventListener=function(s,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+s];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+s],this;for(var i,a=0;a<n.length;a++)if((i=n[a])===t||i.fn===t){n.splice(a,1);break}return 0===n.length&&delete this._callbacks["$"+s],this},C.prototype.emitReserved=C.prototype.emit=function(s){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+s],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(n){i=0;for(var a=(n=n.slice(0)).length;i<a;++i)n[i].apply(this,t)}return this},C.prototype.listeners=function(s){return this._callbacks=this._callbacks||{},this._callbacks["$"+s]||[]},C.prototype.hasListeners=function(s){return!!this.listeners(s).length};const P="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function ge(s,...t){return t.reduce((n,i)=>(s.hasOwnProperty(i)&&(n[i]=s[i]),n),{})}const Ue=setTimeout,Ie=clearTimeout;function F(s,t){t.useNativeTimers?(s.setTimeoutFn=Ue.bind(P),s.clearTimeoutFn=Ie.bind(P)):(s.setTimeoutFn=setTimeout.bind(P),s.clearTimeoutFn=clearTimeout.bind(P))}function Re(s){return"string"==typeof s?function qe(s){let t=0,n=0;for(let i=0,a=s.length;i<a;i++)t=s.charCodeAt(i),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}(s):Math.ceil(1.33*(s.byteLength||s.size))}class se extends Error{constructor(t,n,i){super(t),this.description=n,this.context=i,this.type="TransportError"}}class fe extends C{constructor(t){super(),this.writable=!1,F(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,n,i){return super.emitReserved("error",new se(t,n,i)),this}open(){return("closed"===this.readyState||""===this.readyState)&&(this.readyState="opening",this.doOpen()),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=Ee(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}}const me="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),_e={};let ve,Ce=0,w=0;function ye(s){let t="";do{t=me[s%64]+t,s=Math.floor(s/64)}while(s>0);return t}function xe(){const s=ye(+new Date);return s!==ve?(Ce=0,ve=s):s+"."+ye(Ce++)}for(;w<64;w++)_e[me[w]]=w;function be(s){let t="";for(let n in s)s.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(s[n]));return t}let Oe=!1;try{Oe="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(s){}const Be=Oe;function Me(s){const t=s.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||Be))return new XMLHttpRequest}catch(n){}if(!t)try{return new(P[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}function Je(){}const Fe=null!=new Me({xdomain:!1}).responseType;let Y=(()=>{class s extends C{constructor(n,i){super(),F(this,i),this.opts=i,this.method=i.method||"GET",this.uri=n,this.async=!1!==i.async,this.data=void 0!==i.data?i.data:null,this.create()}create(){const n=ge(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this.opts.xd,n.xscheme=!!this.opts.xs;const i=this.xhr=new Me(n);try{i.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0);for(let a in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(a)&&i.setRequestHeader(a,this.opts.extraHeaders[a])}}catch(a){}if("POST"===this.method)try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(a){}try{i.setRequestHeader("Accept","*/*")}catch(a){}"withCredentials"in i&&(i.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(i.timeout=this.opts.requestTimeout),i.onreadystatechange=()=>{4===i.readyState&&(200===i.status||1223===i.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof i.status?i.status:0)},0))},i.send(this.data)}catch(a){return void this.setTimeoutFn(()=>{this.onError(a)},0)}"undefined"!=typeof document&&(this.index=s.requestsCount++,s.requests[this.index]=this)}onError(n){this.emitReserved("error",n,this.xhr),this.cleanup(!0)}cleanup(n){if(null!=this.xhr){if(this.xhr.onreadystatechange=Je,n)try{this.xhr.abort()}catch(i){}"undefined"!=typeof document&&delete s.requests[this.index],this.xhr=null}}onLoad(){const n=this.xhr.responseText;null!==n&&(this.emitReserved("data",n),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}return s.requestsCount=0,s.requests={},s})();function Pe(){for(let s in Y.requests)Y.requests.hasOwnProperty(s)&&Y.requests[s].abort()}"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",Pe):"function"==typeof addEventListener&&addEventListener("onpagehide"in P?"pagehide":"unload",Pe,!1));const Ye="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,n)=>n(t,0),H=P.WebSocket||P.MozWebSocket,q="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),Ke={websocket:class He extends fe{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),n=this.opts.protocols,i=q?{}:ge(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=q?new H(t,n,i):n?new H(t,n):new H(t)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const a=n===t.length-1;A(t[n],this.supportsBinary,c=>{try{this.ws.send(c)}catch(_){}a&&Ye(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const n=this.opts.secure?"wss":"ws";let i="";this.opts.port&&("wss"===n&&443!==Number(this.opts.port)||"ws"===n&&80!==Number(this.opts.port))&&(i=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=xe()),this.supportsBinary||(t.b64=1);const a=be(t);return n+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(a.length?"?"+a:"")}check(){return!!H}},polling:class De extends fe{constructor(t){if(super(t),this.polling=!1,"undefined"!=typeof location){const i="https:"===location.protocol;let a=location.port;a||(a=i?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||a!==t.port,this.xs=t.secure!==i}this.supportsBinary=Fe&&!(t&&t.forceBase64)}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let i=0;this.polling&&(i++,this.once("pollComplete",function(){--i||n()})),this.writable||(i++,this.once("drain",function(){--i||n()}))}else n()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){((s,t)=>{const n=s.split(te),i=[];for(let a=0;a<n.length;a++){const c=Ee(n[a],t);if(i.push(c),"error"===c.type)break}return i})(t,this.socket.binaryType).forEach(i=>{if("opening"===this.readyState&&"open"===i.type&&this.onOpen(),"close"===i.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(i)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,((s,t)=>{const n=s.length,i=new Array(n);let a=0;s.forEach((c,u)=>{A(c,!1,_=>{i[u]=_,++a===n&&t(i.join(te))})})})(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.query||{};const n=this.opts.secure?"https":"http";let i="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=xe()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.opts.port&&("https"===n&&443!==Number(this.opts.port)||"http"===n&&80!==Number(this.opts.port))&&(i=":"+this.opts.port);const a=be(t);return n+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+(a.length?"?"+a:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new Y(this.uri(),t)}doWrite(t,n){const i=this.request({method:"POST",data:t});i.on("success",n),i.on("error",(a,c)=>{this.onError("xhr post error",a,c)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,i)=>{this.onError("xhr poll error",n,i)}),this.pollXhr=t}}},Qe=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ze=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function oe(s){const t=s,n=s.indexOf("["),i=s.indexOf("]");-1!=n&&-1!=i&&(s=s.substring(0,n)+s.substring(n,i).replace(/:/g,";")+s.substring(i,s.length));let a=Qe.exec(s||""),c={},u=14;for(;u--;)c[ze[u]]=a[u]||"";return-1!=n&&-1!=i&&(c.source=t,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c.pathNames=function $e(s,t){const i=t.replace(/\/{2,9}/g,"/").split("/");return("/"==t.substr(0,1)||0===t.length)&&i.splice(0,1),"/"==t.substr(t.length-1,1)&&i.splice(i.length-1,1),i}(0,c.path),c.queryKey=function Ge(s,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,a,c){a&&(n[a]=c)}),n}(0,c.query),c}let we=(()=>{class s extends C{constructor(n,i={}){super(),n&&"object"==typeof n&&(i=n,n=null),n?(n=oe(n),i.hostname=n.host,i.secure="https"===n.protocol||"wss"===n.protocol,i.port=n.port,n.query&&(i.query=n.query)):i.host&&(i.hostname=oe(i.host).host),F(this,i),this.secure=null!=i.secure?i.secure:"undefined"!=typeof location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=i.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=i.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},i),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=function Le(s){let t={},n=s.split("&");for(let i=0,a=n.length;i<a;i++){let c=n[i].split("=");t[decodeURIComponent(c[0])]=decodeURIComponent(c[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(n){const i=Object.assign({},this.opts.query);i.EIO=4,i.transport=n,this.id&&(i.sid=this.id);const a=Object.assign({},this.opts.transportOptions[n],this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Ke[n](a)}open(){let n;if(this.opts.rememberUpgrade&&s.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))n="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);n=this.transports[0]}this.readyState="opening";try{n=this.createTransport(n)}catch(i){return this.transports.shift(),void this.open()}n.open(),this.setTransport(n)}setTransport(n){this.transport&&this.transport.removeAllListeners(),this.transport=n,n.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",i=>this.onClose("transport close",i))}probe(n){let i=this.createTransport(n),a=!1;s.priorWebsocketSuccess=!1;const c=()=>{a||(i.send([{type:"ping",data:"probe"}]),i.once("packet",V=>{if(!a)if("pong"===V.type&&"probe"===V.data){if(this.upgrading=!0,this.emitReserved("upgrading",i),!i)return;s.priorWebsocketSuccess="websocket"===i.name,this.transport.pause(()=>{a||"closed"!==this.readyState&&(ut(),this.setTransport(i),i.send([{type:"upgrade"}]),this.emitReserved("upgrade",i),i=null,this.upgrading=!1,this.flush())})}else{const pe=new Error("probe error");pe.transport=i.name,this.emitReserved("upgradeError",pe)}}))};function u(){a||(a=!0,ut(),i.close(),i=null)}const _=V=>{const pe=new Error("probe error: "+V);pe.transport=i.name,u(),this.emitReserved("upgradeError",pe)};function k(){_("transport closed")}function ue(){_("socket closed")}function G(V){i&&V.name!==i.name&&u()}const ut=()=>{i.removeListener("open",c),i.removeListener("error",_),i.removeListener("close",k),this.off("close",ue),this.off("upgrading",G)};i.once("open",c),i.once("error",_),i.once("close",k),this.once("close",ue),this.once("upgrading",G),i.open()}onOpen(){if(this.readyState="open",s.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let n=0;const i=this.upgrades.length;for(;n<i;n++)this.probe(this.upgrades[n])}}onPacket(n){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",n),this.emitReserved("heartbeat"),n.type){case"open":this.onHandshake(JSON.parse(n.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const i=new Error("server error");i.code=n.data,this.onError(i);break;case"message":this.emitReserved("data",n.data),this.emitReserved("message",n.data)}}onHandshake(n){this.emitReserved("handshake",n),this.id=n.sid,this.transport.query.sid=n.sid,this.upgrades=this.filterUpgrades(n.upgrades),this.pingInterval=n.pingInterval,this.pingTimeout=n.pingTimeout,this.maxPayload=n.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const n=this.getWritablePackets();this.transport.send(n),this.prevBufferLen=n.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let i=1;for(let a=0;a<this.writeBuffer.length;a++){const c=this.writeBuffer[a].data;if(c&&(i+=Re(c)),a>0&&i>this.maxPayload)return this.writeBuffer.slice(0,a);i+=2}return this.writeBuffer}write(n,i,a){return this.sendPacket("message",n,i,a),this}send(n,i,a){return this.sendPacket("message",n,i,a),this}sendPacket(n,i,a,c){if("function"==typeof i&&(c=i,i=void 0),"function"==typeof a&&(c=a,a=null),"closing"===this.readyState||"closed"===this.readyState)return;(a=a||{}).compress=!1!==a.compress;const u={type:n,data:i,options:a};this.emitReserved("packetCreate",u),this.writeBuffer.push(u),c&&this.once("flush",c),this.flush()}close(){const n=()=>{this.onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),n()},a=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():n()}):this.upgrading?a():n()),this}onError(n){s.priorWebsocketSuccess=!1,this.emitReserved("error",n),this.onClose("transport error",n)}onClose(n,i){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",n,i),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(n){const i=[];let a=0;const c=n.length;for(;a<c;a++)~this.transports.indexOf(n[a])&&i.push(n[a]);return i}}return s.protocol=4,s})();const je="function"==typeof ArrayBuffer,Te=Object.prototype.toString,Xe="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Te.call(Blob),et="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Te.call(File);function re(s){return je&&(s instanceof ArrayBuffer||(s=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(s):s.buffer instanceof ArrayBuffer)(s))||Xe&&s instanceof Blob||et&&s instanceof File}function Q(s,t){if(!s||"object"!=typeof s)return!1;if(Array.isArray(s)){for(let n=0,i=s.length;n<i;n++)if(Q(s[n]))return!0;return!1}if(re(s))return!0;if(s.toJSON&&"function"==typeof s.toJSON&&1===arguments.length)return Q(s.toJSON(),!0);for(const n in s)if(Object.prototype.hasOwnProperty.call(s,n)&&Q(s[n]))return!0;return!1}function tt(s){const t=[],i=s;return i.data=ae(s.data,t),i.attachments=t.length,{packet:i,buffers:t}}function ae(s,t){if(!s)return s;if(re(s)){const n={_placeholder:!0,num:t.length};return t.push(s),n}if(Array.isArray(s)){const n=new Array(s.length);for(let i=0;i<s.length;i++)n[i]=ae(s[i],t);return n}if("object"==typeof s&&!(s instanceof Date)){const n={};for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=ae(s[i],t));return n}return s}function nt(s,t){return s.data=ce(s.data,t),s.attachments=void 0,s}function ce(s,t){if(!s)return s;if(s&&!0===s._placeholder){if("number"==typeof s.num&&s.num>=0&&s.num<t.length)return t[s.num];throw new Error("illegal attachments")}if(Array.isArray(s))for(let n=0;n<s.length;n++)s[n]=ce(s[n],t);else if("object"==typeof s)for(const n in s)Object.prototype.hasOwnProperty.call(s,n)&&(s[n]=ce(s[n],t));return s}const ke=5;var d=(()=>{return(s=d||(d={}))[s.CONNECT=0]="CONNECT",s[s.DISCONNECT=1]="DISCONNECT",s[s.EVENT=2]="EVENT",s[s.ACK=3]="ACK",s[s.CONNECT_ERROR=4]="CONNECT_ERROR",s[s.BINARY_EVENT=5]="BINARY_EVENT",s[s.BINARY_ACK=6]="BINARY_ACK",d;var s})();class st{constructor(t){this.replacer=t}encode(t){return t.type!==d.EVENT&&t.type!==d.ACK||!Q(t)?[this.encodeAsString(t)]:(t.type=t.type===d.EVENT?d.BINARY_EVENT:d.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let n=""+t.type;return(t.type===d.BINARY_EVENT||t.type===d.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(n+=t.nsp+","),null!=t.id&&(n+=t.id),null!=t.data&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=tt(t),i=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(i),a}}class le extends C{constructor(t){super(),this.reviver=t}add(t){let n;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t),n.type===d.BINARY_EVENT||n.type===d.BINARY_ACK?(this.reconstructor=new it(n),0===n.attachments&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else{if(!re(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n))}}decodeString(t){let n=0;const i={type:Number(t.charAt(0))};if(void 0===d[i.type])throw new Error("unknown packet type "+i.type);if(i.type===d.BINARY_EVENT||i.type===d.BINARY_ACK){const c=n+1;for(;"-"!==t.charAt(++n)&&n!=t.length;);const u=t.substring(c,n);if(u!=Number(u)||"-"!==t.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(u)}if("/"===t.charAt(n+1)){const c=n+1;for(;++n&&","!==t.charAt(n)&&n!==t.length;);i.nsp=t.substring(c,n)}else i.nsp="/";const a=t.charAt(n+1);if(""!==a&&Number(a)==a){const c=n+1;for(;++n;){const u=t.charAt(n);if(null==u||Number(u)!=u){--n;break}if(n===t.length)break}i.id=Number(t.substring(c,n+1))}if(t.charAt(++n)){const c=this.tryParse(t.substr(n));if(!le.isPayloadValid(i.type,c))throw new Error("invalid payload");i.data=c}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(n){return!1}}static isPayloadValid(t,n){switch(t){case d.CONNECT:return"object"==typeof n;case d.DISCONNECT:return void 0===n;case d.CONNECT_ERROR:return"string"==typeof n||"object"==typeof n;case d.EVENT:case d.BINARY_EVENT:return Array.isArray(n)&&n.length>0;case d.ACK:case d.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class it{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=nt(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function b(s,t,n){return s.on(t,n),function(){s.off(t,n)}}const ot=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class he extends C{constructor(t,n,i){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[b(t,"open",this.onopen.bind(this)),b(t,"packet",this.onpacket.bind(this)),b(t,"error",this.onerror.bind(this)),b(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){if(ot.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');n.unshift(t);const i={type:d.EVENT,data:n,options:{}};if(i.options.compress=!1!==this.flags.compress,"function"==typeof n[n.length-1]){const u=this.ids++,_=n.pop();this._registerAckCallback(u,_),i.id=u}return this.flags.volatile&&(!(this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable)||!this.connected)||(this.connected?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(t,n){const i=this.flags.timeout;if(void 0===i)return void(this.acks[t]=n);const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===t&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},i);this.acks[t]=(...c)=>{this.io.clearTimeoutFn(a),n.apply(this,[null,...c])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this.packet({type:d.CONNECT,data:t})}):this.packet({type:d.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case d.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case d.EVENT:case d.BINARY_EVENT:this.onevent(t);break;case d.ACK:case d.BINARY_ACK:this.onack(t);break;case d.DISCONNECT:this.ondisconnect();break;case d.CONNECT_ERROR:this.destroy();const i=new Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i)}}onevent(t){const n=t.data||[];null!=t.id&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const i of n)i.apply(this,t)}super.emit.apply(this,t)}ack(t){const n=this;let i=!1;return function(...a){i||(i=!0,n.packet({type:d.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];"function"==typeof n&&(n.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:d.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let i=0;i<n.length;i++)if(t===n[i])return n.splice(i,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const i of n)i.apply(this,t.data)}}}function R(s){this.ms=(s=s||{}).min||100,this.max=s.max||1e4,this.factor=s.factor||2,this.jitter=s.jitter>0&&s.jitter<=1?s.jitter:0,this.attempts=0}R.prototype.duration=function(){var s=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*s);s=0==(1&Math.floor(10*t))?s-n:s+n}return 0|Math.min(s,this.max)},R.prototype.reset=function(){this.attempts=0},R.prototype.setMin=function(s){this.ms=s},R.prototype.setMax=function(s){this.max=s},R.prototype.setJitter=function(s){this.jitter=s};class z extends C{constructor(t,n){var i;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(n=t,t=void 0),(n=n||{}).path=n.path||"/socket.io",this.opts=n,F(this,n),this.reconnection(!1!==n.reconnection),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(i=n.randomizationFactor)&&void 0!==i?i:.5),this.backoff=new R({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==n.timeout?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||y;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=!1!==n.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(n=this.backoff)||void 0===n||n.setMin(t),this)}randomizationFactor(t){var n;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(n=this.backoff)||void 0===n||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(n=this.backoff)||void 0===n||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new we(this.uri,this.opts);const n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;const a=b(n,"open",function(){i.onopen(),t&&t()}),c=b(n,"error",u=>{i.cleanup(),i._readyState="closed",this.emitReserved("error",u),t?t(u):i.maybeReconnectOnOpen()});if(!1!==this._timeout){const u=this._timeout;0===u&&a();const _=this.setTimeoutFn(()=>{a(),n.close(),n.emit("error",new Error("timeout"))},u);this.opts.autoUnref&&_.unref(),this.subs.push(function(){clearTimeout(_)})}return this.subs.push(a),this.subs.push(c),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(b(t,"ping",this.onping.bind(this)),b(t,"data",this.ondata.bind(this)),b(t,"error",this.onerror.bind(this)),b(t,"close",this.onclose.bind(this)),b(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,n){let i=this.nsps[t];return i||(i=new he(this,t,n),this.nsps[t]=i),i}_destroy(t){const n=Object.keys(this.nsps);for(const i of n)if(this.nsps[i].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let i=0;i<n.length;i++)this.engine.write(n[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,n){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const i=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const $={};function T(s,t){"object"==typeof s&&(t=s,s=void 0);const n=function Ve(s,t="",n){let i=s;n=n||"undefined"!=typeof location&&location,null==s&&(s=n.protocol+"//"+n.host),"string"==typeof s&&("/"===s.charAt(0)&&(s="/"===s.charAt(1)?n.protocol+s:n.host+s),/^(https?|wss?):\/\//.test(s)||(s=void 0!==n?n.protocol+"//"+s:"https://"+s),i=oe(s)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const c=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+c+":"+i.port+t,i.href=i.protocol+"://"+c+(n&&n.port===i.port?"":":"+i.port),i}(s,(t=t||{}).path||"/socket.io"),i=n.source,a=n.id;let k;return t.forceNew||t["force new connection"]||!1===t.multiplex||$[a]&&n.path in $[a].nsps?k=new z(i,t):($[a]||($[a]=new z(i,t)),k=$[a]),n.query&&!t.query&&(t.query=n.queryKey),k.socket(n.path,t)}Object.assign(T,{Manager:z,Socket:he,io:T,connect:T});new m.OlP("__SOCKET_IO_CONFIG__");var r=h(2340),l=h(263);let o=(()=>{class s extends class Ae{constructor(t){this.config=t,this.subscribersCounter={},this.eventObservables$={},this.emptyConfig={url:"",options:{}},void 0===t&&(t=this.emptyConfig),this.ioSocket=(T||p)(t.url,t.options)}of(t){this.ioSocket.of(t)}on(t,n){this.ioSocket.on(t,n)}once(t,n){this.ioSocket.once(t,n)}connect(){return this.ioSocket.connect()}disconnect(t){return this.ioSocket.disconnect.apply(this.ioSocket,arguments)}emit(t,...n){return this.ioSocket.emit.apply(this.ioSocket,arguments)}removeListener(t,n){return this.ioSocket.removeListener.apply(this.ioSocket,arguments)}removeAllListeners(t){return this.ioSocket.removeAllListeners.apply(this.ioSocket,arguments)}fromEvent(t){return this.subscribersCounter[t]||(this.subscribersCounter[t]=0),this.subscribersCounter[t]++,this.eventObservables$[t]||(this.eventObservables$[t]=new e.y(n=>{const i=a=>{n.next(a)};return this.ioSocket.on(t,i),()=>{this.subscribersCounter[t]--,0===this.subscribersCounter[t]&&(this.ioSocket.removeListener(t,i),delete this.eventObservables$[t])}}).pipe((0,O.B)())),this.eventObservables$[t]}fromOneTimeEvent(t){return new Promise(n=>this.once(t,n))}}{constructor(n){super({url:r.N.socket_url,options:{query:{userId:JSON.parse(localStorage.getItem("auth")).user._id}}}),this.authService=n,this.url=`${r.N.url_api}`,this.socket=this.ioSocket,this.users=this.listen("connected"),this.message=this.listen("message"),this.socket=this.ioSocket,this.getSocketId()}registerUser(n){console.log("Tu socket:",n)}getSocketId(){this.listen("connected").subscribe(n=>{localStorage.setItem("socketId",n)}),this.listen("disconnect").subscribe(n=>{localStorage.removeItem("socketId")})}listen(n){const i=new m.vpe;return this.socket.on(n,a=>i.emit(a)),i}emit(n,i){this.socket.emit(n,i)}}return s.\u0275fac=function(n){return new(n||s)(m.LFG(l.e))},s.\u0275prov=m.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},6853:(Se,E,h)=>{h.r(E),h.d(E,{MainModule:()=>ht});var y=h(9808),p=h(3075),m=h(9291),e=h(5e3);let O=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-home"]],decls:1,vars:0,consts:[["src","assets/images/logo-home.png","alt","Logo de senntmessages"]],template:function(o,s){1&o&&e._UZ(0,"img",0)},styles:["[_nghost-%COMP%]{background:rgba(68,188,255,.12);display:none;height:100vh;width:100%}img[_ngcontent-%COMP%]{max-width:100%;margin:0 auto;display:block;position:relative;top:50%;transform:translateY(-50%)}@media (min-width: 1024px){[_nghost-%COMP%]{display:block}}"]}),r})();var v=h(7579),Z=h(9300),U=h(2340),M=h(9233),L=h(3716),f=h(4450),g=h(8187),x=h(263),A=h(3175),I=h(273),S=h(5620),B=h(5245),N=h(2525),j=h(7423),W=h(3251),X=h(4118);const ee={af:"Afrikaans",sq:"Albanian",ar:"Arabic",hy:"Armenian",az:"Azerbaijani",bn:"Bengali",bs:"Bosnian",bg:"Bulgarian",ca:"Catalan",ceb:"Cebuano",ny:"Chichewa","zh-CN":"Chinese Simplified","zh-TW":"Chinese Traditional",co:"Corsican",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",eo:"Esperanto",et:"Estonian",tl:"Filipino",fi:"Finnish",fr:"French",fy:"Frisian",gl:"Galician",ka:"Georgian",de:"German",el:"Greek",gu:"Gujarati",ht:"Haitian Creole",ha:"Hausa",haw:"Hawaiian",iw:"Hebrew",hi:"Hindi",hmn:"Hmong",hu:"Hungarian",is:"Icelandic",ig:"Igbo",id:"Indonesian",ga:"Irish",it:"Italian",ja:"Japanese",jw:"Javanese",kn:"Kannada",kk:"Kazakh",km:"Khmer",ko:"Korean",ku:"Kurdish (Kurmanji)",ky:"Kyrgyz",lo:"Lao",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mn:"Mongolian",my:"Myanmar (Burmese)",ne:"Nepali",no:"Norwegian",ps:"Pashto",fa:"Persian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian",sm:"Samoan",gd:"Scots Gaelic",sr:"Serbian",st:"Sesotho",sn:"Shona",sd:"Sindhi",si:"Sinhala",sk:"Slovak",sl:"Slovenian",es:"Spanish",su:"Sudanese",sw:"Swahili",sv:"Swedish",tg:"Tajik",ta:"Tamil",te:"Telugu",th:"Thai",tr:"Turkish",uz:"Uzbek",vi:"Vietnamese",cy:"Welsh",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",zu:"Zulu"};var te=h(8372),ne=h(8386),J=h(773),de=h(2368),C=h(1054);function Ze(r,l){if(1&r&&(e.TgZ(0,"div",14)(1,"a",15),e.ALo(2,"location"),e._uU(3,"Shared location"),e.qZA()()),2&r){const o=e.oxw();e.xp6(1),e.s9C("href",e.lcZ(2,1,o.shareData),e.LSH)}}function P(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",21),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.cleanSearch())}),e._uU(1,"close"),e.qZA()}}function ge(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"div",16)(1,"input",17),e.NdJ("focus",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.search())})("blur",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.search(!1))}),e.qZA(),e.TgZ(2,"mat-icon",18),e._uU(3,"search"),e.qZA(),e._UZ(4,"mat-spinner",19),e.YNc(5,P,2,0,"mat-icon",20),e.qZA()}if(2&r){const o=e.oxw();e.xp6(1),e.Q6J("formControl",o.inputSearch),e.xp6(4),e.Q6J("ngIf",o.inputSearch.value)}}function Ue(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"div",25),e.NdJ("click",function(){const n=e.CHM(o).$implicit,i=e.oxw(2);return e.KtG(i.selectLang(n))}),e._uU(1),e.qZA()}if(2&r){const o=l.$implicit;e.xp6(1),e.Oqu(o[1])}}function Ie(r,l){if(1&r&&(e.TgZ(0,"div",22)(1,"div",23)(2,"span"),e._uU(3,"Actual language: "),e.qZA(),e._uU(4),e.qZA(),e.YNc(5,Ue,2,1,"div",24),e.qZA()),2&r){const o=e.oxw();e.xp6(4),e.Oqu(o.langActive),e.xp6(1),e.Q6J("ngForOf",o.langs)}}let F=(()=>{class r{constructor(o,s){var t,n;this.userService=o,this.authService=s,this.eventOpenAlert=new v.x,this.inputSearch=new p.NI,this.active=!1,this.share=!1,this.shareData=null;try{this.langActive=JSON.parse(localStorage.getItem("language")).lang}catch(i){localStorage.removeItem("language")}this.active=!!this.langActive,this.langs=Object.entries(ee),this.user=this.authService.getMyUser(),null!==(n=null===(t=this.user)||void 0===t?void 0:t.location)&&void 0!==n&&n.latitud&&(this.share=!0,this.shareData=this.user.location)}ngOnInit(){}close(){const o=document.getElementById("div_settings");o.classList.add("animate__slideOutLeft"),setTimeout(()=>{o.style.display="none",o.classList.remove("animate__slideOutLeft")},500)}loading(o=!0){const s=document.getElementById("loading");o?s.style.display="block":setTimeout(()=>{s.style.display="none"},1e3)}cleanSearch(){document.getElementById("inputSearch").focus(),this.inputSearch.setValue("")}search(o=!0){o?this.searchSubscription=this.inputSearch.valueChanges.pipe((0,te.b)(100)).subscribe(s=>{if(s){const t=this.langs.filter(n=>{const i=s.toLowerCase();return!!n[1].toLowerCase().includes(i)&&n});this.langs=t}else this.langs=Object.entries(ee)}):this.searchSubscription.unsubscribe()}selectLang(o){localStorage.setItem("language",JSON.stringify({lang:o[1],abr:o[0]})),this.langActive=o[1],(0,g.O1)(this.eventOpenAlert,`Messages language updated to ${o[1]} successfully`)}toggleActive(o){this.active=o.checked,this.active?this.selectLang(["en","English"]):localStorage.removeItem("language")}toggleShare(o){this.share=o.checked,this.share?((0,g.O1)(this.eventOpenAlert,"Getting and sending location"),this.userService.getPosition().then(s=>{this.userService.updateLocation({longitud:s.coords.longitude,latitud:s.coords.latitude}).subscribe(n=>{(0,g.M6)(this.eventOpenAlert),this.shareData=n.location,this.authService.updateAuthUser(n)})}).catch(s=>(0,g.O1)(this.eventOpenAlert,"Unable to record audio. Give microphone permission and try again"))):(this.shareData=null,(0,g.O1)(this.eventOpenAlert,"Removing location"),this.userService.deleteLocation().subscribe(s=>{console.log(s),(0,g.M6)(this.eventOpenAlert),this.shareData=null,this.authService.updateAuthUser(s)}))}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(ne.K),e.Y36(x.e))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-settings"]],decls:21,vars:6,consts:[[1,"container"],[1,"header"],[1,"back",3,"click"],[1,"main"],["id","options_settings"],[1,"share_location"],[1,"text"],[3,"checked","change"],["class","data",4,"ngIf"],[1,"lang","notTranslate"],["class","search",4,"ngIf"],["id","langs"],["class","langs",4,"ngIf"],[3,"eventOpenAlert"],[1,"data"],["mat-raised-button","","target","_blank",3,"href"],[1,"search"],["type","text","id","inputSearch","placeholder","Search language","autocomplete","off",3,"formControl","focus","blur"],[1,"search-icon"],["id","loading",1,"spinner-users"],["id","clean-search",3,"click",4,"ngIf"],["id","clean-search",3,"click"],[1,"langs"],[1,"lang"],["class","lang",3,"click",4,"ngFor","ngForOf"],[1,"lang",3,"click"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-icon",2),e.NdJ("click",function(){return s.close()}),e._uU(3,"arrow_back"),e.qZA(),e.TgZ(4,"p"),e._uU(5,"Select messages language"),e.qZA()(),e.TgZ(6,"div",3)(7,"div",4)(8,"div",5)(9,"div",6)(10,"h3"),e._uU(11,"Share location"),e.qZA(),e.TgZ(12,"mat-slide-toggle",7),e.NdJ("change",function(n){return s.toggleShare(n)}),e.qZA()(),e.YNc(13,Ze,4,3,"div",8),e.qZA(),e.TgZ(14,"div",9),e._uU(15,"Translate messages "),e.TgZ(16,"mat-slide-toggle",7),e.NdJ("change",function(n){return s.toggleActive(n)}),e.qZA()(),e.YNc(17,ge,6,2,"div",10),e.qZA(),e.TgZ(18,"div",11),e.YNc(19,Ie,6,2,"div",12),e.qZA()(),e._UZ(20,"app-mini-alert",13),e.qZA()),2&o&&(e.xp6(12),e.Q6J("checked",s.share),e.xp6(1),e.Q6J("ngIf",null==s.shareData?null:s.shareData.latitud),e.xp6(3),e.Q6J("checked",s.active),e.xp6(1),e.Q6J("ngIf",s.active),e.xp6(2),e.Q6J("ngIf",s.active),e.xp6(1),e.Q6J("eventOpenAlert",s.eventOpenAlert.asObservable()))},dependencies:[y.sg,y.O5,B.Hw,j.zs,J.Ou,de.Rr,p.Fj,p.JJ,p.oH,X.O,C.p],styles:["[_ngcontent-%COMP%]:root{--animate-delay: 0s}.animate__delay-2s[_ngcontent-%COMP%]{animation-delay:.2s!important}[_nghost-%COMP%]{display:none;position:absolute;top:0;z-index:100;height:100%;width:100%;background:#fff}.container[_ngcontent-%COMP%]{height:100%}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background:#6405B3;background:#446678;background:#480481;height:110px;height:100px;display:flex;align-items:end;padding:20px 10px 18px 15px;color:#fff}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:20px;padding:0 15px 3px 13px}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer;border-radius:50px;width:30px;height:30px;display:flex;align-items:center;justify-content:center}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{background:#56049a}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{height:calc(100% - 120px);width:100%;overflow-y:auto;overflow-x:hidden;padding-bottom:25px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#8d0cf8}.container[_ngcontent-%COMP%]   .lang[_ngcontent-%COMP%]{color:#000;padding:20px 40px;font-size:19px;cursor:pointer;border-top:1px solid rgba(72,4,129,.0784313725)}.container[_ngcontent-%COMP%]   .lang[_ngcontent-%COMP%]:hover{background:#f0f8ff}.container[_ngcontent-%COMP%]   .lang[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}.container[_ngcontent-%COMP%]   .lang.notTranslate[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.search[_ngcontent-%COMP%]{display:flex;justify-content:center;position:relative;border-bottom:1px solid #efefef;position:sticky;top:0;background:#fff;padding-top:10px;z-index:100}.search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;width:94%;margin:10px auto;background:rgba(68,188,255,.3490196078);padding:10px 30px 10px 42px;border-radius:50px;color:#686868}.search[_ngcontent-%COMP%]   mat-icon.search-icon[_ngcontent-%COMP%]{position:absolute;left:5.2%;top:28px;color:#919191}.search[_ngcontent-%COMP%]   #clean-search[_ngcontent-%COMP%]{width:20px!important;height:20px!important;color:#919191;cursor:pointer;position:absolute;right:7%;top:27px}.alert[_ngcontent-%COMP%]{font-size:13px;color:red;width:-moz-fit-content;width:fit-content;margin-bottom:3px}.alert.error[_ngcontent-%COMP%]{color:red}.alert.ok[_ngcontent-%COMP%]{color:#22a522}#options_settings[_ngcontent-%COMP%]{color:#000;position:sticky;top:0;background:#fff;z-index:300}#options_settings[_ngcontent-%COMP%]   .share_location[_ngcontent-%COMP%]{padding:20px 45px 0}#options_settings[_ngcontent-%COMP%]   .share_location[_ngcontent-%COMP%]:hover{background:#f0f8ff}#options_settings[_ngcontent-%COMP%]   .share_location[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:baseline}#options_settings[_ngcontent-%COMP%]   .share_location[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px}#options_settings[_ngcontent-%COMP%]   .share_location[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{padding-bottom:25px}"]}),r})();var Ne=h(7544);let Re=(()=>{class r{transform(o){let s=o;if(o){const t=new Date,n=new Date(Date.parse(o)),i=`${n.getDate()}/${se(n.getMonth())}/${n.getFullYear()}`;let a=new Date;a=`${a.getDate()}/${se(a.getMonth())}/${a.getFullYear()}`;let c=new Date(t.getTime()-864e5);c=`${c.getDate()}/${se(c.getMonth())}/${c.getFullYear()}`;let u=new Date(t.getTime()-6048e5);if(i===a){let _=n.getMinutes();_<10&&(_=`0${_}`),s=`${n.getHours()}:${_}`}else s=i===c?"Yesterday":n.getTime()>u.getTime()&&n.getTime()<t.getTime()&&n.getDay()!==t.getDay()?function qe(r){switch(r){case 1:default:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";case 0:return"Sunday"}}(n.getDay()):i}return s}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275pipe=e.Yjl({name:"createDate",type:r,pure:!0}),r})();function se(r){switch(r){case 0:default:return"01";case 1:return"02";case 2:return"03";case 3:return"04";case 4:return"05";case 5:return"06";case 6:return"07";case 7:return"08";case 8:return"09";case 9:return"10";case 10:return"11";case 11:return"12"}}function fe(r,l){1&r&&(e.TgZ(0,"p",5),e._uU(1,"No chats found "),e._UZ(2,"br"),e._uU(3," Start one!"),e.qZA())}const me=function(r){return{read:r}};function D(r,l){if(1&r&&(e.TgZ(0,"mat-icon",17),e._uU(1,"done_all"),e.qZA()),2&r){const o=e.oxw().$implicit;e.Q6J("ngClass",e.VKq(1,me,null==o.lastMessage?null:o.lastMessage.read))}}function _e(r,l){1&r&&(e.TgZ(0,"mat-icon"),e._uU(1,"photo_camera"),e.qZA())}function Ce(r,l){1&r&&(e.TgZ(0,"mat-icon"),e._uU(1,"insert_drive_file"),e.qZA())}function w(r,l){1&r&&(e.TgZ(0,"mat-icon"),e._uU(1,"keyboard_voice"),e.qZA())}function ve(r,l){1&r&&(e.TgZ(0,"mat-icon"),e._uU(1,"location_on"),e.qZA())}function ye(r,l){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&r){const o=e.oxw().$implicit;e.xp6(1),e.Oqu((null==o.lastMessage?null:o.lastMessage.message)||"~~")}}function rt(r,l){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&r){const o=e.oxw().$implicit;e.xp6(1),e.Oqu((null==o.lastMessage?null:o.lastMessage.message.trim())||"Photo")}}function xe(r,l){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&r){const o=e.oxw().$implicit;e.xp6(1),e.Oqu((null==o.lastMessage?null:o.lastMessage.doc.name)||"Document")}}function be(r,l){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&r){const o=e.oxw().$implicit;e.xp6(1),e.Oqu((null==o.lastMessage||null==o.lastMessage.doc?null:o.lastMessage.doc.time)||"Audio")}}function Le(r,l){1&r&&(e.TgZ(0,"p"),e._uU(1,"Location"),e.qZA())}function Oe(r,l){if(1&r&&(e.TgZ(0,"p"),e._UZ(1,"span",18),e.qZA()),2&r){const o=e.oxw().$implicit;e.xp6(1),e.Q6J("matBadge",o.noRead)}}function Be(r,l){if(1&r&&(e.TgZ(0,"div",7),e._UZ(1,"img",8),e.TgZ(2,"div",9)(3,"div",10)(4,"p",11),e._uU(5),e.qZA(),e.TgZ(6,"p",12),e._uU(7),e.ALo(8,"createDate"),e.qZA()(),e.TgZ(9,"div",13)(10,"div",14),e.YNc(11,D,2,3,"mat-icon",15),e.YNc(12,_e,2,0,"mat-icon",16),e.YNc(13,Ce,2,0,"mat-icon",16),e.YNc(14,w,2,0,"mat-icon",16),e.YNc(15,ve,2,0,"mat-icon",16),e.YNc(16,ye,2,1,"p",16),e.YNc(17,rt,2,1,"p",16),e.YNc(18,xe,2,1,"p",16),e.YNc(19,be,2,1,"p",16),e.YNc(20,Le,2,0,"p",16),e.qZA(),e.YNc(21,Oe,2,1,"p",16),e.qZA()()()),2&r){const o=l.$implicit,s=e.oxw(3);e.MGl("routerLink","/chat/",o._id,""),e.xp6(1),e.Q6J("src",s.getUser(o.users).image.url,e.LSH)("alt",s.user.name),e.xp6(4),e.Oqu(s.getUser(o.users).name),e.xp6(2),e.Oqu(e.lcZ(8,16,(null==o.lastMessage?null:o.lastMessage.createdAt)||o.updatedAt)),e.xp6(4),e.Q6J("ngIf",(null==o.lastMessage?null:o.lastMessage.from)===s.user._id),e.xp6(1),e.Q6J("ngIf",null==o.lastMessage?null:o.lastMessage.image),e.xp6(1),e.Q6J("ngIf",(null==o.lastMessage?null:o.lastMessage.doc)&&"audio"!=(null==o||null==o.lastMessage||null==o.lastMessage.doc?null:o.lastMessage.doc.mimetype.split("/")[0])),e.xp6(1),e.Q6J("ngIf",(null==o.lastMessage?null:o.lastMessage.doc)&&"audio"==(null==o||null==o.lastMessage||null==o.lastMessage.doc?null:o.lastMessage.doc.mimetype.split("/")[0])),e.xp6(1),e.Q6J("ngIf",null==o.lastMessage?null:o.lastMessage.location),e.xp6(1),e.Q6J("ngIf",!(null!=o.lastMessage&&o.lastMessage.image)),e.xp6(1),e.Q6J("ngIf",null==o.lastMessage?null:o.lastMessage.image),e.xp6(1),e.Q6J("ngIf",(null==o.lastMessage?null:o.lastMessage.doc)&&"audio"!=(null==o.lastMessage||null==o.lastMessage.doc?null:o.lastMessage.doc.mimetype.split("/")[0])),e.xp6(1),e.Q6J("ngIf",(null==o.lastMessage?null:o.lastMessage.doc)&&"audio"==(null==o.lastMessage||null==o.lastMessage.doc?null:o.lastMessage.doc.mimetype.split("/")[0])),e.xp6(1),e.Q6J("ngIf",null==o.lastMessage?null:o.lastMessage.location),e.xp6(1),e.Q6J("ngIf",o.noRead&&o.noRead>0)}}function Me(r,l){if(1&r&&e.YNc(0,Be,22,18,"div",6),2&r){const o=e.oxw(2);e.Q6J("ngForOf",o.chats)}}function Je(r,l){if(1&r&&(e.TgZ(0,"div",2),e.YNc(1,fe,4,0,"p",3),e.YNc(2,Me,1,1,"ng-template",null,4,e.W1O),e.qZA()),2&r){const o=e.MAs(3),s=e.oxw();e.xp6(1),e.Q6J("ngIf",s.chats.length<1)("ngIfElse",o)}}function Fe(r,l){1&r&&e._UZ(0,"mat-spinner",19)}let De=(()=>{class r{constructor(o,s,t){this.authService=o,this.chatService=s,this.store=t}ngOnInit(){this.user=this.authService.getMyUser(),this.updateChats.subscribe(o=>{this.user=this.authService.getMyUser(),this.getChats()}),this.getChats(),this.subcribeChats()}getUser(o){return o.find(s=>s._id!=this.user._id)}getChats(){this.chatService.getAllChats().subscribe(o=>{this.store.dispatch(new f.vh(o))})}subcribeChats(){this.store.select("chats").subscribe(o=>{this.chats=this.chatService.sortChats([...o])})}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(x.e),e.Y36(A.a),e.Y36(S.yh))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-chats"]],inputs:{updateChats:"updateChats"},decls:3,vars:2,consts:[["class","chats",4,"ngIf","ngIfElse"],["loading",""],[1,"chats"],["class","textNoFound",4,"ngIf","ngIfElse"],["chatsContainer",""],[1,"textNoFound"],["routerLinkActive","active","class","chat",3,"routerLink",4,"ngFor","ngForOf"],["routerLinkActive","active",1,"chat",3,"routerLink"],[3,"src","alt"],[1,"chat__info"],[1,"user"],[1,"user__name"],[1,"chat__info__time"],[1,"chat__div-message"],[1,"chat__info__message"],["class","icon-done",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"icon-done",3,"ngClass"],["matBadgeOverlap","false",3,"matBadge"],["id","loading",1,"spinner-chat"]],template:function(o,s){if(1&o&&(e.YNc(0,Je,4,2,"div",0),e.YNc(1,Fe,1,0,"ng-template",null,1,e.W1O)),2&o){const t=e.MAs(2);e.Q6J("ngIf",s.chats)("ngIfElse",t)}},dependencies:[y.mk,y.sg,y.O5,m.rH,m.Od,B.Hw,Ne.k,J.Ou,Re],styles:[".chat[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:space-between;align-items:center;padding:11px 20px 11px 14px}.chat[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:47px;height:47px;border-radius:50px;object-fit:cover;margin-right:10px}.chat__info[_ngcontent-%COMP%]{border-bottom:1px solid #efefef;padding-bottom:5px;padding-top:6.5px;width:100%;height:55px}.chat__info__time[_ngcontent-%COMP%]{color:#446678;font-size:12px}.chat__info__message[_ngcontent-%COMP%]{color:#535353;font-size:16px;display:flex;align-items:center;white-space:nowrap;margin-right:5px!important;overflow:hidden;border-bottom:none}.chat__info__message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:inline;text-overflow:ellipsis;overflow:hidden}.chat__info__message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transform:scale(.7)}.chat__info__message[_ngcontent-%COMP%]   .read[_ngcontent-%COMP%]{color:#009ef7}.chat__div-message[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 22px;align-items:center;height:28px}.chat[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{max-width:18px;max-height:18px}.chat[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;align-items:center}.chat[_ngcontent-%COMP%]   .user__name[_ngcontent-%COMP%]{font-size:20px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:10px!important;color:#000!important}.chat[_ngcontent-%COMP%]:hover{background:#f9f9f9}.chat.active[_ngcontent-%COMP%]{background:#f0f0f0}.textNoFound[_ngcontent-%COMP%]{text-align:center;font-size:17px;margin-top:30px!important;color:#8a8a8a}"]}),r})();function Y(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",8),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.cleanSearch())}),e._uU(1,"close"),e.qZA()}}function Pe(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"div",10),e.NdJ("click",function(){const n=e.CHM(o).$implicit,i=e.oxw(2);return e.KtG(i.createChat(n._id,n.chatId))}),e._UZ(1,"img",11),e.TgZ(2,"div",12)(3,"div",13)(4,"p",14),e._uU(5),e.qZA(),e.TgZ(6,"p",15),e._uU(7),e.qZA()(),e.TgZ(8,"mat-icon"),e._uU(9,"comment"),e.qZA()()()}if(2&r){const o=l.$implicit;e.xp6(1),e.Q6J("src",o.image.url,e.LSH)("alt",o.name),e.xp6(4),e.Oqu(o.name),e.xp6(2),e.Oqu(o.username)}}function Ye(r,l){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,Pe,10,4,"div",9),e.qZA()),2&r){const o=e.oxw();e.xp6(1),e.Q6J("ngForOf",o.users)}}function H(r,l){1&r&&(e.TgZ(0,"p",16),e._uU(1,"No users found."),e.qZA())}let ie=(()=>{class r{constructor(o,s,t,n){this.userService=o,this.chatService=s,this.authService=t,this.router=n,this.chatsUpdated=new e.vpe,this.inputSearch=new p.NI}ngOnInit(){this.getUsers(),this.update.subscribe(o=>{this.getUsers()})}getUsers(){this.userService.getAll().subscribe(o=>{this.users=o,this.allUsers=o})}createChat(o,s){s?this.router.navigate([`/chat/${s}`]):(this.loading(),this.chatService.getChatId(o).subscribe(t=>{this.users.find(n=>n._id==o).chatId=t._id,this.chatsUpdated.emit(),this.router.navigate([`/chat/${t._id}`]),this.loading(!1)}))}loading(o=!0){const s=document.getElementById("loading");o?s.style.display="block":setTimeout(()=>{s.style.display="none"},1e3)}cleanSearch(){document.getElementById("inputSearch").focus(),this.inputSearch.setValue("")}search(o=!0){o?this.searchSubscription=this.inputSearch.valueChanges.pipe((0,te.b)(100)).subscribe(s=>{const t=this.allUsers.filter(n=>{const i=n.name.toUpperCase(),a=n.username.toUpperCase(),c=s.toUpperCase();return!(!i.includes(c)&&!a.includes(c))&&n});this.users=t}):this.searchSubscription.unsubscribe()}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(ne.K),e.Y36(A.a),e.Y36(x.e),e.Y36(m.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-users"]],inputs:{update:["updateUsers","update"]},outputs:{chatsUpdated:"chatsUpdated"},decls:10,vars:4,consts:[[1,"users"],[1,"search"],["type","text","id","inputSearch","placeholder","Search users by name and username","autocomplete","off",3,"formControl","focus","blur"],[1,"search-icon"],["id","loading",1,"spinner-users"],["id","clean-search",3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],["noFound",""],["id","clean-search",3,"click"],["class","user",3,"click",4,"ngFor","ngForOf"],[1,"user",3,"click"],[3,"src","alt"],[1,"data"],[1,"data__text"],[1,"name"],[1,"username"],[1,"textNoFound"]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"input",2),e.NdJ("focus",function(){return s.search()})("blur",function(){return s.search(!1)}),e.qZA(),e.TgZ(3,"mat-icon",3),e._uU(4,"search"),e.qZA(),e._UZ(5,"mat-spinner",4),e.YNc(6,Y,2,0,"mat-icon",5),e.qZA(),e.YNc(7,Ye,2,1,"div",6),e.YNc(8,H,2,0,"ng-template",null,7,e.W1O),e.qZA()),2&o){const t=e.MAs(9);e.xp6(2),e.Q6J("formControl",s.inputSearch),e.xp6(4),e.Q6J("ngIf",s.inputSearch.value),e.xp6(1),e.Q6J("ngIf",(null==s.users?null:s.users.length)>0)("ngIfElse",t)}},dependencies:[y.sg,y.O5,B.Hw,J.Ou,p.Fj,p.JJ,p.oH],styles:[".users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{cursor:pointer;display:grid;padding:10px 20px;grid-template-columns:auto 1fr}.users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50px;object-fit:cover;margin-right:10px}.users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]   .data[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 24px;align-items:center;border-bottom:1px solid #efefef;padding-bottom:5px;padding-top:3px}.users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]   .data__text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-right:11px}.users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]   .data__text[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:18px;color:#000}.users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]   .data__text[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{font-size:14px;color:#446678}.users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]   .data__text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;margin-right:4px!important}.users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#446678}.users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]:hover{background:#f7f7f7}.users[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]{display:flex;justify-content:center;position:relative;border-bottom:1px solid #efefef;position:sticky;top:0;background:#fff}.users[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;outline:none;width:94%;margin:10px auto;background:rgba(68,188,255,.3490196078);padding:10px 30px 10px 42px;border-radius:50px;color:#686868}.users[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   mat-icon.search-icon[_ngcontent-%COMP%]{position:absolute;left:5.2%;top:19px;color:#919191}.users[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   #clean-search[_ngcontent-%COMP%]{width:20px!important;height:20px!important;color:#919191;cursor:pointer;position:absolute;right:7%;top:16px}.textNoFound[_ngcontent-%COMP%]{text-align:center;font-size:17px;margin-top:30px!important;color:#8a8a8a}@media (min-width: 400px){.users[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   #clean-search[_ngcontent-%COMP%]{right:6%}}@media (min-width: 600px){.users[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   #clean-search[_ngcontent-%COMP%]{right:5%}}@media (min-width: 1024px){.users[_ngcontent-%COMP%]   .search[_ngcontent-%COMP%]   #clean-search[_ngcontent-%COMP%]{right:6.5%}}"]}),r})();var K=h(2933),q=h(7322),He=h(7531);function Ke(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",32),e.NdJ("click",function(){e.CHM(o),e.oxw();const t=e.MAs(32),n=e.oxw();return e.KtG(n.toggleEdit(t))}),e._uU(1,"edit"),e.qZA()}}function Qe(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",33),e.NdJ("click",function(){e.CHM(o),e.oxw();const t=e.MAs(32),n=e.oxw();return e.KtG(n.toggleEdit(t,!0))}),e._uU(1,"close"),e.qZA()}}function ze(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",34),e.NdJ("click",function(){e.CHM(o),e.oxw();const t=e.MAs(32),n=e.oxw();return e.KtG(n.save(t))}),e._uU(1,"check"),e.qZA()}}function oe(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Must have at least 3 letters "),e.qZA())}function $e(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Name is required "),e.qZA())}function Ge(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",32),e.NdJ("click",function(){e.CHM(o),e.oxw();const t=e.MAs(43),n=e.oxw();return e.KtG(n.toggleEdit(t))}),e._uU(1,"edit"),e.qZA()}}function we(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",33),e.NdJ("click",function(){e.CHM(o),e.oxw();const t=e.MAs(43),n=e.oxw();return e.KtG(n.toggleEdit(t,!0))}),e._uU(1,"close"),e.qZA()}}function at(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",34),e.NdJ("click",function(){e.CHM(o),e.oxw();const t=e.MAs(43),n=e.oxw();return e.KtG(n.save(t))}),e._uU(1,"check"),e.qZA()}}function Ve(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Must have at least 3 letters "),e.qZA())}function je(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Username is required "),e.qZA())}function We(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Username is already in use "),e.qZA())}function Te(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",32),e.NdJ("click",function(){e.CHM(o),e.oxw();const t=e.MAs(55),n=e.oxw();return e.KtG(n.toggleEdit(t))}),e._uU(1,"edit"),e.qZA()}}function Xe(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",33),e.NdJ("click",function(){e.CHM(o),e.oxw();const t=e.MAs(55),n=e.oxw();return e.KtG(n.toggleEdit(t,!0))}),e._uU(1,"close"),e.qZA()}}function et(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"mat-icon",34),e.NdJ("click",function(){e.CHM(o),e.oxw();const t=e.MAs(55),n=e.oxw();return e.KtG(n.save(t))}),e._uU(1,"check"),e.qZA()}}function re(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter a valid email address "),e.qZA())}function Q(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email is already in use "),e.qZA())}function tt(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Email is required "),e.qZA())}function ae(r,l){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Please enter a valid email address "),e.qZA())}function nt(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"button",35),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.toggleChangePassword())}),e._uU(1,"Change password"),e.qZA()}}function ce(r,l){1&r&&(e.TgZ(0,"p",36),e._uU(1,"Password updated successfully"),e.qZA())}function ke(r,l){1&r&&e._UZ(0,"mat-spinner",47)}function d(r,l){1&r&&(e.TgZ(0,"p",48),e._uU(1,"The current password is incorrect"),e.qZA())}function st(r,l){1&r&&(e.TgZ(0,"p",48),e._uU(1,"All fields are required"),e.qZA())}function le(r,l){1&r&&(e.TgZ(0,"p",48),e._uU(1,"The new password must have at least 8 letters"),e.qZA())}function it(r,l){1&r&&(e.TgZ(0,"p",48),e._uU(1,"Confirm password don't match"),e.qZA())}function b(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"form",37),e.NdJ("ngSubmit",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.changePassword())}),e.TgZ(1,"div",38)(2,"p"),e._uU(3,"Change your password"),e.qZA(),e.YNc(4,ke,1,0,"mat-spinner",39),e.qZA(),e.YNc(5,d,2,0,"p",40),e.YNc(6,st,2,0,"p",40),e.YNc(7,le,2,0,"p",40),e.YNc(8,it,2,0,"p",40),e.TgZ(9,"mat-form-field")(10,"mat-label"),e._uU(11,"Actual password"),e.qZA(),e._UZ(12,"input",41),e.TgZ(13,"button",42),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.hide.one=!t.hide.one)}),e.TgZ(14,"mat-icon"),e._uU(15),e.qZA()()(),e.TgZ(16,"mat-form-field")(17,"mat-label"),e._uU(18,"New password"),e.qZA(),e._UZ(19,"input",43),e.TgZ(20,"button",42),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.hide.two=!t.hide.two)}),e.TgZ(21,"mat-icon"),e._uU(22),e.qZA()()(),e.TgZ(23,"mat-form-field")(24,"mat-label"),e._uU(25,"Confirm new password"),e.qZA(),e._UZ(26,"input",44),e.TgZ(27,"button",42),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.hide.three=!t.hide.three)}),e.TgZ(28,"mat-icon"),e._uU(29),e.qZA()()(),e.TgZ(30,"div",45)(31,"button",35),e.NdJ("click",function(){e.CHM(o);const t=e.oxw(2);return e.KtG(t.toggleChangePassword(!1))}),e._uU(32,"Cancel"),e.qZA(),e.TgZ(33,"button",46),e._uU(34,"Save"),e.qZA()()()}if(2&r){const o=e.oxw(2);e.Q6J("formGroup",o.formChangePassword),e.xp6(4),e.Q6J("ngIf",o.loadingChange),e.xp6(1),e.Q6J("ngIf",o.errChangedPassword),e.xp6(1),e.Q6J("ngIf",o.requiredChangePassword),e.xp6(1),e.Q6J("ngIf",o.minLength&&!o.requiredChangePassword),e.xp6(1),e.Q6J("ngIf",o.dontMatch&&!o.requiredChangePassword&&!o.minLength),e.xp6(4),e.Q6J("type",o.hide.one?"password":"text"),e.xp6(1),e.uIk("aria-label","Hide password")("aria-pressed",o.hide),e.xp6(2),e.Oqu(o.hide.one?"visibility_off":"visibility"),e.xp6(4),e.Q6J("type",o.hide.two?"password":"text"),e.xp6(1),e.uIk("aria-label","Hide password")("aria-pressed",o.hide),e.xp6(2),e.Oqu(o.hide.two?"visibility_off":"visibility"),e.xp6(4),e.Q6J("type",o.hide.three?"password":"text"),e.xp6(1),e.uIk("aria-label","Hide password")("aria-pressed",o.hide),e.xp6(2),e.Oqu(o.hide.three?"visibility_off":"visibility")}}function ot(r,l){if(1&r){const o=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"mat-icon",3),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.closeProfile())}),e._uU(3,"arrow_back"),e.qZA(),e.TgZ(4,"p"),e._uU(5,"Profile"),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6),e._UZ(9,"img",7),e.qZA(),e.TgZ(10,"button",8)(11,"mat-icon"),e._uU(12,"linked_camera"),e.qZA()(),e.TgZ(13,"mat-menu",9,10)(15,"button",11),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.viewPhoto(t.user.image.url))}),e.TgZ(16,"span"),e._uU(17,"View photo"),e.qZA()(),e.TgZ(18,"button",11),e.NdJ("click",function(){e.CHM(o);const t=e.MAs(25),n=e.oxw();return e.KtG(n.uploadPhoto(t))}),e.TgZ(19,"span"),e._uU(20,"Upload photo"),e.qZA()(),e.TgZ(21,"button",11),e.NdJ("click",function(){e.CHM(o);const t=e.oxw();return e.KtG(t.removePhoto())}),e.TgZ(22,"span"),e._uU(23,"Remove photo"),e.qZA()()()(),e.TgZ(24,"input",12,13),e.NdJ("change",function(t){e.CHM(o);const n=e.oxw();return e.KtG(n.uploadPhoto(!1,t))}),e.qZA(),e.TgZ(26,"div",14)(27,"div",15)(28,"label"),e._uU(29,"Your name"),e.qZA(),e.TgZ(30,"div",16),e._UZ(31,"input",17,18),e.YNc(33,Ke,2,0,"mat-icon",19),e.YNc(34,Qe,2,0,"mat-icon",20),e.YNc(35,ze,2,0,"mat-icon",21),e.qZA(),e.YNc(36,oe,2,0,"mat-error",22),e.YNc(37,$e,2,0,"mat-error",22),e.qZA(),e.TgZ(38,"div",15)(39,"label"),e._uU(40,"Your username"),e.qZA(),e.TgZ(41,"div",16),e._UZ(42,"input",23,24),e.YNc(44,Ge,2,0,"mat-icon",19),e.YNc(45,we,2,0,"mat-icon",20),e.YNc(46,at,2,0,"mat-icon",21),e.qZA(),e.YNc(47,Ve,2,0,"mat-error",22),e.YNc(48,je,2,0,"mat-error",22),e.YNc(49,We,2,0,"mat-error",22),e.qZA(),e.TgZ(50,"div",15)(51,"label"),e._uU(52,"Your email"),e.qZA(),e.TgZ(53,"div",16),e._UZ(54,"input",25,26),e.YNc(56,Te,2,0,"mat-icon",19),e.YNc(57,Xe,2,0,"mat-icon",20),e.YNc(58,et,2,0,"mat-icon",21),e.qZA(),e.YNc(59,re,2,0,"mat-error",22),e.YNc(60,Q,2,0,"mat-error",22),e.YNc(61,tt,2,0,"mat-error",22),e.YNc(62,ae,2,0,"mat-error",22),e.qZA()(),e.TgZ(63,"div",27),e.YNc(64,nt,2,0,"button",28),e.YNc(65,ce,2,0,"p",29),e.YNc(66,b,35,18,"form",30),e.qZA()(),e._UZ(67,"app-mini-alert",31),e.qZA()}if(2&r){const o=e.MAs(14),s=e.MAs(32),t=e.MAs(43),n=e.MAs(55),i=e.oxw();e.xp6(9),e.Q6J("src",i.user.image.url,e.LSH)("alt",i.user.name),e.xp6(1),e.Q6J("matMenuTriggerFor",o),e.xp6(21),e.Q6J("formControl",i.name),e.xp6(2),e.Q6J("ngIf",s.disabled),e.xp6(1),e.Q6J("ngIf",!s.disabled),e.xp6(1),e.Q6J("ngIf",!s.disabled),e.xp6(1),e.Q6J("ngIf",i.name.hasError("minlength")&&i.name.touched),e.xp6(1),e.Q6J("ngIf",i.name.hasError("required")&&i.name.touched),e.xp6(5),e.Q6J("formControl",i.username),e.xp6(2),e.Q6J("ngIf",t.disabled),e.xp6(1),e.Q6J("ngIf",!t.disabled),e.xp6(1),e.Q6J("ngIf",!t.disabled),e.xp6(1),e.Q6J("ngIf",i.username.hasError("minlength")&&i.username.touched),e.xp6(1),e.Q6J("ngIf",i.username.hasError("required")&&i.username.touched),e.xp6(1),e.Q6J("ngIf",i.username.hasError("not_available")&&i.username.touched&&i.username.value!=i.user.username),e.xp6(5),e.Q6J("formControl",i.email),e.xp6(2),e.Q6J("ngIf",n.disabled),e.xp6(1),e.Q6J("ngIf",!n.disabled),e.xp6(1),e.Q6J("ngIf",!n.disabled),e.xp6(1),e.Q6J("ngIf",i.email.hasError("email")&&i.email.touched),e.xp6(1),e.Q6J("ngIf",i.email.hasError("not_available")&&i.email.touched&&i.email.value!=i.user.email),e.xp6(1),e.Q6J("ngIf",i.email.hasError("required")&&i.email.touched),e.xp6(1),e.Q6J("ngIf",i.email.hasError("not_valid")&&i.email.touched),e.xp6(2),e.Q6J("ngIf",!i.showChangePassword),e.xp6(1),e.Q6J("ngIf",i.okChangedPassword),e.xp6(1),e.Q6J("ngIf",i.showChangePassword),e.xp6(1),e.Q6J("eventOpenAlert",i.eventOpenAlert.asObservable())}}let he=(()=>{class r{constructor(o,s,t,n){this.authService=o,this.userService=s,this.formBuilder=t,this.store=n,this.eventOpenAlert=new v.x,this.disabled=!1,this.loadingChange=!1,this.okChangedPassword=!1,this.hide={one:!0,two:!0,three:!0},this.showChangePassword=!1,this.errChangedPassword=!1}ngOnInit(){this.store.select("user").subscribe(o=>this.user=o),this.update.subscribe(o=>{this.load()}),this.load()}load(){this.loadUser(),this.createChangePassword()}closeProfile(){const o=document.getElementById("div_profile");o.classList.add("animate__slideOutLeft"),setTimeout(()=>{o.style.display="none",o.classList.remove("animate__slideOutLeft")},500)}loadUser(){this.name=new p.NI({value:this.user.name,disabled:!0},[p.kI.required,p.kI.minLength(3)]),this.username=new p.NI({value:this.user.username,disabled:!0},[p.kI.required,p.kI.minLength(3)],K.R.validateUsername(this.authService)),this.email=new p.NI({value:this.user.email,disabled:!0},[p.kI.required,p.kI.email],[K.R.validateEmail(this.authService),K.R.emailIsValid(this.userService)])}toggleEdit(o,s=!1,t=!1){s?(o.value=t||this.user[o.name],this[o.name].value=t||this.user[o.name],o.disabled=!0,this[o.name].disable(),this[o.name].markAsUntouched()):(this[o.name].enable(),o.disabled=!1,o.focus())}toggleChangePassword(o=!0){this.loadingChange=!1,this.errChangedPassword=!1,this.showChangePassword=o}save(o){const s=o.name,t=this[s].value;this[s].valid&&(t!=this.user[s]?(this.toggleEdit(o,!0,t),this.userService.updateProfile(s,t).subscribe(n=>{this.saveUserUpdated(n)})):this.toggleEdit(o,!0))}saveUserUpdated(o){const t={token:this.authService.getAuth().token,user:o};this.authService.saveAuth(t)}createChangePassword(){this.formChangePassword=this.formBuilder.group({actual:["",[p.kI.required]],password:["",[p.kI.required,p.kI.minLength(8)]],password2:["",[p.kI.required]]},{validators:K.R.matchPasswords})}changePassword(){if(this.formChangePassword.valid){this.loadingChange=!0;const o=this.formChangePassword.get("actual").value,s=this.formChangePassword.get("password").value;this.authService.changePassword(o,s).subscribe(t=>{this.okChangedPassword=!0,this.loadingChange=!1,this.errChangedPassword=!1,this.cleanFormChangePassword()},t=>{this.errChangedPassword=!0,this.loadingChange=!1})}else this.formChangePassword.markAllAsTouched()}cleanFormChangePassword(){this.formChangePassword.reset(),this.formChangePassword.markAsUntouched(),this.formChangePassword.clearValidators(),this.toggleChangePassword(!1),this.hide={one:!0,two:!0,three:!0},setTimeout(()=>{this.okChangedPassword=!1},5e3)}get requiredChangePassword(){const o=this.formChangePassword.get("actual"),s=this.formChangePassword.get("password"),t=this.formChangePassword.get("password2");return o.hasError("required")&&o.touched||s.hasError("required")&&s.touched||t.hasError("required")&&t.touched}get dontMatch(){return this.formChangePassword.hasError("match_password")&&this.formChangePassword.get("password2").touched}get minLength(){const o=this.formChangePassword.get("password");return o.hasError("minlength")&&o.touched}viewPhoto(o){window.open(o)}removePhoto(){this.user.image.default&&"true"==this.user.image.default?(0,g.O1)(this.eventOpenAlert,"The default image is already"):((0,g.O1)(this.eventOpenAlert,"Removing profile picture..."),this.userService.updatePhoto(!1,!0).subscribe(o=>{(0,g.O1)(this.eventOpenAlert,"Profile picture removed successfully"),this.authService.updateAuthUser(o)}))}sendPhoto(o){const s=new FormData;s.append("file",o),this.userService.updatePhoto(s).subscribe(t=>{this.disabled=!1,(0,g.O1)(this.eventOpenAlert,"Profile picture updated successfully"),this.authService.updateAuthUser(t)})}uploadPhoto(o,s=!1){if(s){if(!this.disabled){const t=s.target.files[0];this.isImage(t)?(this.disabled=!0,(0,g.O1)(this.eventOpenAlert,"Uploading...",!1),document.getElementById("inputFile").value="",this.sendPhoto(t)):s.target.files.length>0&&(s.value="",(0,g.O1)(this.eventOpenAlert,"Only images allowed"))}}else this.disabled?(0,g.O1)(this.eventOpenAlert,"An image is already being uploaded, please wait...",!1):o.click()}isImage(o){return"image"===(null==o?void 0:o.type.split("/")[0])}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(x.e),e.Y36(ne.K),e.Y36(p.qu),e.Y36(S.yh))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-profile"]],inputs:{update:["updateProfile","update"]},decls:1,vars:1,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"header"],[1,"back",3,"click"],[1,"main"],[1,"image","animate__animated","animate__zoomIn","animate__faster","animate__delay-2s"],[1,"image_modal"],[3,"src","alt"],["mat-icon-button","","aria-label","Menu to open options to image",3,"matMenuTriggerFor"],["yPosition","above"],["menu","matMenu"],["mat-menu-item","",3,"click"],["type","file","accept","image/*","id","inputFile",2,"display","none",3,"change"],["file",""],[1,"inputs","animate__animated","animate__fadeInDown"],[1,"div_input"],[1,"border"],["type","text","matInput","","autocomplete","off","name","name",3,"formControl"],["input_name",""],["class","btn-edit",3,"click",4,"ngIf"],["class","btn-close",3,"click",4,"ngIf"],["class","btn-save",3,"click",4,"ngIf"],[4,"ngIf"],["type","text","matInput","","autocomplete","off","name","username",3,"formControl"],["input_username",""],["type","email","matInput","","autocomplete","off","name","email",3,"formControl"],["input_email",""],[1,"change_password","animate__animated","animate__fadeInDown"],["mat-raised-button","",3,"click",4,"ngIf"],["class","alert ok",4,"ngIf"],["class","div_change_password",3,"formGroup","ngSubmit",4,"ngIf"],[3,"eventOpenAlert"],[1,"btn-edit",3,"click"],[1,"btn-close",3,"click"],[1,"btn-save",3,"click"],["mat-raised-button","",3,"click"],[1,"alert","ok"],[1,"div_change_password",3,"formGroup","ngSubmit"],[1,"text"],["id","spinner-change_password",4,"ngIf"],["class","alert error",4,"ngIf"],["matInput","","formControlName","actual",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],["matInput","","formControlName","password",3,"type"],["matInput","","formControlName","password2",3,"type"],[1,"btns"],["type","submit","mat-raised-button","","color","primary"],["id","spinner-change_password"],[1,"alert","error"]],template:function(o,s){1&o&&e.YNc(0,ot,68,28,"div",0),2&o&&e.Q6J("ngIf",null==s.user?null:s.user.image)},dependencies:[y.O5,B.Hw,q.TO,q.KE,q.hX,q.R9,N.VK,N.OP,N.p6,j.lW,J.Ou,He.Nt,p._Y,p.Fj,p.JJ,p.JL,p.oH,p.sg,p.u,X.O],styles:["[_ngcontent-%COMP%]:root{--animate-delay: 0s}.animate__delay-2s[_ngcontent-%COMP%]{animation-delay:.2s!important}[_nghost-%COMP%]{display:none;position:absolute;top:0;z-index:100;height:100%;width:100%;background:#fff}.container[_ngcontent-%COMP%]{height:100%}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{background:#6405B3;background:#446678;background:#480481;height:110px;height:100px;display:flex;align-items:end;padding:20px 10px 18px 15px;color:#fff}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:20px;padding:0 15px 3px 13px}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer;border-radius:50px;width:30px;height:30px;display:flex;align-items:center;justify-content:center}.container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{background:#56049a}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{height:calc(100% - 120px);width:100%;overflow-y:auto;overflow-x:hidden;padding:25px 30px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#8d0cf8}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative;width:210px;margin:0 auto}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:210px;height:210px;object-fit:cover;border-radius:50%;display:block;margin:0 auto 20px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:not(.container   .main[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img.default)[_ngcontent-%COMP%]{box-shadow:0 0 10px #ccc}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;bottom:0;right:15px;background:#40b940;color:#fff;display:flex;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .div_input[_ngcontent-%COMP%]{color:#446678;position:relative;margin-bottom:8px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .div_input[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .div_input[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#324f5e;width:100%;padding:5px 52px 5px 0;background:none;border:none;outline:none;font-size:19px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .div_input[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not(.container   .main[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .div_input[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled){border-bottom:1px solid #446678}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .div_input[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer;color:#446678;position:absolute;right:0;top:24px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .inputs[_ngcontent-%COMP%]   .div_input[_ngcontent-%COMP%]   mat-icon.btn-close[_ngcontent-%COMP%]{right:25px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .change_password[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin:8px 0;padding:5px 20px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .div_change_password[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:10px 20px;box-shadow:0 0 4px #ccc;margin-top:20px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .div_change_password[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{font-size:16px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .div_change_password[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]{display:flex;justify-content:end}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .div_change_password[_ngcontent-%COMP%]   .btns[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px;margin-bottom:3px}.container[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .div_change_password[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:15px;margin:3px 0}.alert[_ngcontent-%COMP%]{font-size:13px;color:red;width:-moz-fit-content;width:fit-content;margin-bottom:3px}.alert.error[_ngcontent-%COMP%]{color:red}.alert.ok[_ngcontent-%COMP%]{color:#22a522}"]}),r})();function R(r,l){1&r&&(e._UZ(0,"img",31),e._uU(1," Chats "))}function z(r,l){1&r&&(e._UZ(0,"img",32),e._uU(1," Users "))}const T=[{path:"",component:(()=>{class r{constructor(o,s,t,n,i){this.authService=o,this.chatService=s,this.router=t,this.socketService=n,this.store=i,this.eventOpenAlert=new v.x,this.eventUpdateChats=new v.x,this.eventUpdateProfileUser=new v.x,this.eventUpdateUsers=new v.x,this.authService.saveInStore(M.Q,!0),this.store.select("user").subscribe(a=>{this.user=a})}ngOnInit(){window.addEventListener("resize",()=>{this.appHeight()}),this.appHeight(),this.resize(this.router.url),this.subUrl=this.router.events.pipe((0,Z.h)(o=>o instanceof m.m2)).subscribe(o=>{this.resize(o.url)}),this.listenMessages(),this.listenSchedules(),this.eventUpdateChats.next(!0),this.eventUpdateProfileUser.next(!0),this.eventUpdateUsers.next(!0)}ngOnDestroy(){this.subUrl.unsubscribe(),this.subDeleteMessage.unsubscribe(),this.subReadMessages.unsubscribe(),this.subDeleteSchedule.unsubscribe()}listenSchedules(){this.subDeleteSchedule=this.socketService.listen(U.N.events.SCHEDULE_DELETEMESSAGE).subscribe(o=>{null!=o&&o.send&&(0,g.O1)(this.eventOpenAlert,"A scheduled message has just been sent sent")})}appHeight(){document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)}resize(o){"chat"!==(o=o.split("/")[1])&&"message"!==o&&(document.getElementById("chats-container").style.visibility="visible")}logout(){this.authService.logout()}openProfile(){document.getElementById("div_profile").style.display="block"}openSettings(){document.getElementById("div_settings").style.display="block"}updateChats(){this.eventUpdateChats.next(!0)}eventUpdateProfile(){this.eventUpdateProfileUser.next(!0)}updateUsers(){this.eventUpdateUsers.next(!0)}updateNoRead(o){if(!o.read&&o.to==this.user._id){let s;this.store.select("chats").forEach(a=>s=a);let t=s.filter(a=>a._id!=o.chatId);const n=s.find(a=>a._id==o.chatId),i=Object.assign(Object.assign({},n),{noRead:n.noRead+1});t.push(i),this.store.dispatch(new f.vh(this.chatService.sortChats(t)))}}thereChat(o){let s;return this.store.select("chats").forEach(t=>s=t),s.find(t=>t._id==o)}listenMessages(){this.socketService.listen(U.N.events.NEW_MESSAGE).subscribe(o=>{this.thereChat(o.chatId)?(this.store.dispatch(new f.lq({myuser:this.user,message:o})),this.store.dispatch(new L.PV({chatId:o.chatId,message:o})),o.noRead||this.updateNoRead(o)):this.updateChats()}),this.subDeleteMessage=this.socketService.listen(U.N.events.MESSAGE_DELETED).subscribe(o=>{let s;this.store.dispatch(new L.$6({messageId:o._id,chatId:o.chatId})),this.store.select("messages").forEach(t=>{t.forEach(n=>{n.chatId!=o.chatId||(s=n.messages)})}),this.updateChats()}),this.subReadMessages=this.socketService.listen(U.N.events.READ_MESSAGES).subscribe(o=>{this.store.dispatch(new f.Vo({chatId:o.chatId}))})}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(x.e),e.Y36(A.a),e.Y36(m.F0),e.Y36(I.$),e.Y36(S.yh))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-main"]],decls:67,vars:9,consts:[[1,"container"],["id","chats-container",1,"chats-container"],[1,"header"],[1,"header__top"],[1,"me"],[3,"src","alt"],[1,"div-menu"],["mat-icon-button","","aria-label","menu",3,"matMenuTriggerFor"],[1,"icon-menu"],["xPosition","before",1,"main-menu"],["menu","matMenu"],[1,"item-menu"],["mat-menu-item","",3,"click"],[1,"mr-icon"],["mat-menu-item","",3,"matMenuTriggerFor"],[2,"margin-right","7px"],[1,"main-menu"],["menuMessages","matMenu"],["routerLink","/message/multiple",1,"item-menu"],["mat-menu-item",""],["routerLink","/message/schedule",1,"item-menu"],[1,"header__bottom"],["mat-stretch-tabs","","color","primary","backgroundColor","primary",1,"tabs"],["mat-tab-label",""],[1,"app-chats"],[3,"updateChats"],[3,"updateUsers","chatsUpdated"],["id","div_profile",1,"app-profile","animate__animated","animate__slideInLeft","animate__faster",3,"updateProfile"],["id","div_settings",1,"app-profile","animate__animated","animate__slideInLeft","animate__faster"],[1,"chat-container"],[3,"eventOpenAlert"],["src","assets/images/chat-icon.png","alt","messages icon"],["src","assets/images/users-icon.png","alt","users icon"]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"header",2)(3,"div",3)(4,"div",4),e._UZ(5,"img",5),e.TgZ(6,"p"),e._uU(7),e.qZA()(),e.TgZ(8,"div",6)(9,"button",7)(10,"mat-icon",8),e._uU(11,"more_vert"),e.qZA()(),e.TgZ(12,"mat-menu",9,10)(14,"div",11)(15,"div",12),e.NdJ("click",function(){return s.openProfile()}),e.TgZ(16,"mat-icon",13),e._uU(17,"person_pin"),e.qZA(),e.TgZ(18,"span"),e._uU(19,"Profile"),e.qZA()()(),e.TgZ(20,"div",11)(21,"div",14)(22,"mat-icon",15),e._uU(23," message"),e.qZA(),e.TgZ(24,"span"),e._uU(25,"Messages"),e.qZA()()(),e.TgZ(26,"mat-menu",16,17)(28,"div",18)(29,"div",19)(30,"mat-icon"),e._uU(31,"people"),e.qZA(),e.TgZ(32,"span"),e._uU(33,"Send multiple"),e.qZA()()(),e.TgZ(34,"div",20)(35,"div",19)(36,"mat-icon"),e._uU(37,"access_time"),e.qZA(),e.TgZ(38,"span"),e._uU(39,"Schedule"),e.qZA()()()(),e.TgZ(40,"div",11)(41,"div",12),e.NdJ("click",function(){return s.openSettings()}),e.TgZ(42,"mat-icon",13),e._uU(43,"settings"),e.qZA(),e.TgZ(44,"span"),e._uU(45,"Settings"),e.qZA()()(),e.TgZ(46,"div",11)(47,"span",12),e.NdJ("click",function(){return s.logout()}),e.TgZ(48,"mat-icon",13),e._uU(49,"exit_to_app"),e.qZA(),e.TgZ(50,"span"),e._uU(51,"Logout"),e.qZA()()()()()(),e.TgZ(52,"div",21)(53,"mat-tab-group",22)(54,"mat-tab"),e.YNc(55,R,2,0,"ng-template",23),e.TgZ(56,"div",24),e._UZ(57,"app-chats",25),e.qZA()(),e.TgZ(58,"mat-tab"),e.YNc(59,z,2,0,"ng-template",23),e.TgZ(60,"div",24)(61,"app-users",26),e.NdJ("chatsUpdated",function(){return s.updateChats()}),e.qZA()()()()()(),e._UZ(62,"app-profile",27)(63,"app-settings",28),e.qZA(),e.TgZ(64,"div",29),e._UZ(65,"router-outlet"),e.qZA()(),e._UZ(66,"app-mini-alert",30)),2&o){const t=e.MAs(13),n=e.MAs(27);e.xp6(5),e.Q6J("src",s.user.image.url,e.LSH)("alt",s.user.name),e.xp6(2),e.Oqu(s.user.name),e.xp6(2),e.Q6J("matMenuTriggerFor",t),e.xp6(12),e.Q6J("matMenuTriggerFor",n),e.xp6(36),e.Q6J("updateChats",s.eventUpdateChats),e.xp6(4),e.Q6J("updateUsers",s.eventUpdateUsers),e.xp6(1),e.Q6J("updateProfile",s.eventUpdateProfileUser),e.xp6(4),e.Q6J("eventOpenAlert",s.eventOpenAlert.asObservable())}},dependencies:[m.lC,m.rH,B.Hw,N.VK,N.OP,N.p6,j.lW,W.SP,W.uD,W.uX,X.O,F,De,ie,he],styles:["[_ngcontent-%COMP%]:root{--app-height: 100%}.app-profile.animate__faster[_ngcontent-%COMP%]{--animate-duration: .7s}.chats-container[_ngcontent-%COMP%]{border-right:1px solid #c3cbcf;height:100%}.chat-container[_ngcontent-%COMP%]{max-width:calc(100vw - 410px)}.header__top[_ngcontent-%COMP%]{align-items:center;background:#6405B3;color:#fff;display:grid;grid-template-columns:1fr 40px;padding:10px 20px 0}.header[_ngcontent-%COMP%]   .me[_ngcontent-%COMP%]{display:flex;align-items:center;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.header[_ngcontent-%COMP%]   .me[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{cursor:default;font-size:21px;text-overflow:ellipsis;overflow:hidden}.header[_ngcontent-%COMP%]   .me[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50px;height:40px;width:40px;object-fit:cover;margin-right:12px}.header[_ngcontent-%COMP%]   .icon-menu[_ngcontent-%COMP%]{transform:scale(1.5)}.header__bottom[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-right:10px}.item-menu[_ngcontent-%COMP%]{background:#fff;border-radius:50px;box-shadow:0 1px 1px #ccc;color:#fff;margin-top:10px}.item-menu[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center}.item-menu[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .item-menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#757575}.item-menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{display:inline-block;margin:0 15px 0 5px;transform:scale(1.8)}.chats-container[_ngcontent-%COMP%]{position:relative;z-index:20;visibility:hidden}.mr-icon[_ngcontent-%COMP%]{margin-right:7px!important}.app-chats[_ngcontent-%COMP%]{max-height:100%;overflow-y:auto;height:calc(var(--app-height) - 98px)}.app-chats[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.app-chats[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#8d0cf8}@media (min-width: 1024px){.header[_ngcontent-%COMP%]   .me[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block}.container[_ngcontent-%COMP%]{display:grid;grid-template-columns:410px 1fr}.chats-container[_ngcontent-%COMP%]{display:block;visibility:visible}.app-chats[_ngcontent-%COMP%]{height:calc(100vh - 98px)}}@media (min-width: 1651px){.chats-container[_ngcontent-%COMP%]{border:1px solid #f1f1f1}}"]}),r})(),children:[{path:"",component:O},{path:"chat/:id",loadChildren:()=>Promise.all([h.e(772),h.e(187)]).then(h.bind(h,1187)).then(r=>r.ChatModule)},{path:"message",loadChildren:()=>Promise.all([h.e(772),h.e(393)]).then(h.bind(h,393)).then(r=>r.MessageModule)}]},{path:"**",redirectTo:"/"}];let Ae=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[m.Bz.forChild(T),m.Bz]}),r})();var ct=h(793),lt=h(4466);let ht=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[y.ez,Ae,ct.q,p.UX,lt.m]}),r})()},1054:(Se,E,h)=>{h.d(E,{p:()=>p});var y=h(5e3);let p=(()=>{class m{transform(O){return`https://www.google.com/maps?q=${O.latitud},${O.longitud}&z=17&hl=es`}}return m.\u0275fac=function(O){return new(O||m)},m.\u0275pipe=y.Yjl({name:"location",type:m,pure:!0}),m})()}}]);